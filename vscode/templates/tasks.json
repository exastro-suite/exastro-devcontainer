/*
#   Copyright 2025 NEC Corporation
#
#   Licensed under the Apache License, Version 2.0 (the "License");
#   you may not use this file except in compliance with the License.
#   You may obtain a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#   Unless required by applicable law or agreed to in writing, software
#   distributed under the License is distributed on an "AS IS" BASIS,
#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#   See the License for the specific language governing permissions and
#   limitations under the License.
*/
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Coverage Report",
      "type": "shell",
      "command": "coverage report --data-file=${env:SOURCE_ROOT}/.coverage",
      "problemMatcher": []
    },
    {
      "label": "Unittest Container Up - mariadb",
      "type": "shell",
      "command": "${env:SOURCE_ROOT}/tests/docker-compose-up-mariadb.sh",
      "problemMatcher": []
    },
    {
      "label": "Unittest Container Up - mysql",
      "type": "shell",
      "command": "${env:SOURCE_ROOT}/tests/docker-compose-up-mysql.sh",
      "problemMatcher": []
    },
    {
      "label": "AutoRun Task",
      "dependsOrder": "sequence",
      "dependsOn": [
          "WaitMigration",
          "RestartAllApiService"
      ],
      "runOptions": {
        "runOn": "folderOpen"
      },
      "problemMatcher": []
    },
    {
      "label": "WaitMigration",
      "type": "shell",
      "command": "${workspaceFolder}/exastro-devcontainer/bin/taskWaitMigration.sh",
      "problemMatcher": []
    },
    {
      "label": "RestartAllApiService",
      "dependsOrder": "parallel",
      "dependsOn": [
        "platform-auth",
        "platform-api",
        "ita-api-organization",
        "ita-api-admin",
        "ita-api-ansible-execution-receiver",
        "ita-api-oase-receiver"
      ],
      "problemMatcher": []
    },
    {
      "label": "platform-auth",
      "type": "shell",
      "command": "${workspaceFolder}/exastro-devcontainer/bin/taskRestartAPIservice.sh platform-auth 8801 not-stop-httpd /app/api.py",
      "problemMatcher": []
    },
    {
      "label": "platform-api",
      "type": "shell",
      "command": "${workspaceFolder}/exastro-devcontainer/bin/taskRestartAPIservice.sh platform-api 8000 stop-httpd /app/api.py",
      "problemMatcher": []
    },
    {
      "label": "ita-api-organization",
      "type": "shell",
      "command": "${workspaceFolder}/exastro-devcontainer/bin/taskRestartAPIservice.sh ita-api-organization 8000 stop-httpd /exastro/api.py",
      "problemMatcher": []
    },
    {
      "label": "ita-api-admin",
      "type": "shell",
      "command": "${workspaceFolder}/exastro-devcontainer/bin/taskRestartAPIservice.sh ita-api-admin 8079 stop-httpd /exastro/api.py",
      "problemMatcher": []
    },
    {
      "label": "ita-api-ansible-execution-receiver",
      "type": "shell",
      "command": "${workspaceFolder}/exastro-devcontainer/bin/taskRestartAPIservice.sh ita-api-ansible-execution-receiver 8000 stop-httpd /exastro/api.py",
      "problemMatcher": []
    },
    {
      "label": "ita-api-oase-receiver",
      "type": "shell",
      "command": "${workspaceFolder}/exastro-devcontainer/bin/taskRestartAPIservice.sh ita-api-oase-receiver 8000 stop-httpd /exastro/api.py",
      "problemMatcher": []
    }
  ]
}
